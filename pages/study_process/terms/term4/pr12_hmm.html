<div class='col-md-12'>
<h1>Поиск домена с помощью HMM</h1>
<p>HMM - hidden Markov models - метод скрытых марковских моделей позволяет строит профили для последовательностей доменов.
</p>
<p>
Из использованного ранее семейства доменов MATH (PF00917) было
выбрано семейство видов, в котором достаточно представлен данный домен.
Было выбрано семейство Drosophilidae. Оно представлено в семействе 29 последовательностями.
На дереве в семействе было обозначено 24 последовательности, но в таблице с таксономией 
их оказалось больше.
Другие семейства насекомых и того же порядка Diptera также присутствуют
<a href='pages/study_process/terms/term4/pr12/drosofila-id'>[список выбранных AC]</a>.

</p>
<p>
Из таблицы в таксономией, составленной в предыдущем практикуме, были извлечены в отдельных файл все идентификаторы 
АС последовательностей нужного семейства.
Из общего выравнивания доменов, скачанного с PFAM, с помощью python скрипта 
<a href='http://kodomo.fbb.msu.ru/wiki/2015/4/task11/scripts'>filter-flignment.py</a>
было извлечено выравнивание MATH доменов в белка из видов семейства Drosophilidae.
</p>
<p>
Также из той же таблицы были скачаны идентификаторы всех последовательностей, содержащих данный домен.
По этим АС из Uniprot были получены все последовательности данных белков в формате fasta.
</p>
 <h3>Применение марковской модели</h3>
 
<p>Для построения профиля домена семейства использовался пакет HMMER.
Сначала по выравниванию доменов Drosophilidae был построен профиль (hmm2build).
Профиль был откалиброван ( hmm2calibrate). Затем по полученной из uniprot базе
был проведен поиск доменов семейства с помощью профиля (hmm2search).
</p>

<p>Программа hmm2search выдает много различных данных, среди которых мы использовали 
веса (score), присвоенные каждой последовательности из базы.
</p>
<p>Эти данные были сначала обработаны в электронной таблице 
<a href='pages/study_process/terms/term4/pr12/results.ods'>[ods]</a>
<a href='pages/study_process/terms/term4/pr12/results.xlsx'>[xlsx]</a>, 
а затем создан входной файл для построения ROC-кривой,
содержащий в первом столбце извлеченный идентификатор последовательности AC,
а во втором &ndash; вес, присвоенный профилем 
<a href='pages/study_process/terms/term4/pr12/scores-data'>[посмотреть файл]</a>. </p>

<p>Была построена гистограмма весов - рис.1.</p>

<figure style=''>
            <figcaption>Рис.1. Гистограмма весов</figcaption>
            <img src='pages/study_process/terms/term4/pr12/histogram.png' style='' width = 70%>
        </figure>

<p>Данные для построения ROC-кривой были получены с помощью 
<a href='pages/study_process/terms/term4/pr12/make-roc.py'>скрипта</a>.
Он принимает входной файл весов (-s) с AC и весами описанный выше, 
реальные данные (-r) &ndash; список AC, действительно принадлежащих семейству. 
Выходной файл содержит координаты для построения ROC-кривой, а также столбец e-value для поиска оптимальной точки
порога 
<a href='pages/study_process/terms/term4/pr12/roc-data'>[посмотреть выходной файл]</a>.


</p>
<p>Для сравнения в скрипт была добавлена автоматическая случайная генерация списка 
"действительных" идентификаторов, если таковой список не указан. 
Эти данные позволяют частично проверить работу скрипта (и модуля random:).
	
	
</p>
<p>
<a href='pages/study_process/terms/term4/pr12/plot-roc.in'>Gnuplot скриптом</a> 
была построена ROC-кривая для реальных данных и для случайно сгенерированных - рис.2ды.
Как и ожидалось, случайные данные дают AUC (area under ROC curve, площадь под ROC-кривой) около 0,5,
что говорит о случайности отбора и низком качестве критерия, которого здесь и не было.
А вот реальные данные данные дают кривую, на которой можно найти почти идеальные точку.
Если пороговое значения e-value = 9.8e-50 (в моем подсчете последовательности
с пороговым значением e-value классифицируются как имеющие признак), то критерий поиска имеет характеристики,
представленные в таблице 1. Такое значение порога делает использование 
профидя максимально эффективным (TPR максимален,FPR очень мал).

</p>
<div class='col-md-6'>
<figure style=''>
            <figcaption>Рис.2. ROC-кривая</figcaption>
            <img src='pages/study_process/terms/term4/pr12/results.png' style='' width = 100%>
        </figure>
	
</div>
<div class='col-md-6'>
<table class='table table-bordered col-md-6'>
  <caption>Таб.1. Характеристики профиля для порога e-value = 9.8e-50</caption>
  <tbody class='small'>
	  <tr>
		<td>На самом деле</td>
		<td>принадлежит подсемейству </td>
		<td>не принадлежит </td>
		<td>сумма</td>
		</tr>
	  <tr>
		<td>Выше порога по профилю</td>
		<td>29</td>
		<td>10</td>
		<td>39</td>
		</tr>
	  <tr>
		<td>Ниже порога</td>
		<td>0</td>
		<td>3739</td>
		<td>3739</td>
		</tr>
	  <tr>
		<td>сумма</td>
		<td>29</td>
		<td>3749</td>
		<td>3778</td>
		</tr>
	  
	  
	  </tbody>
	  </table>
	  
</div>
<div class='col-md-12'>
<p>Профиль работает очень хорошо с предложенным значением порога. Его можно использовать для выделения семейства.</p>
</div>
